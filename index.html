<!DOCTYPE HTML>
<html>
  <head>
    <title>Multilanguage PhoneGap Application Example</title>
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/i18next.min.js"></script>
    <script type="text/javascript" charset="utf-8" src="cordova.js"></script>
    <script type="text/javascript" charset="utf-8">
        var
            language = 'English';
            code = getCode(language);
            
        console.log('appInit');
        console.log('language = ' + language + ', code = ' + code);
            
        function getLanguage()
        {
            navigator.globalization.getPreferredLanguage
            (
                function(lang)
                {
                    language = lang.value;
                    code = getCode(lang.value);
                    
                    console.log('Success getting language -- getPreferredLanguage() success callback called!');
                    console.log('language = ' + language + ', code = ' + code);
                    console.log(lang);
                    
                    i18n.setLng(code, function(t)
                    {
                        $('body').i18n();
                    });
                },
                function(error)
                {
                    console.log('Failed to get language -- getPreferredLanguage() error callback called!');
                    console.log(error);
                    
                    alert(i18n.t('messages.error'));
                }
            );
        }
        
        function getCode(lang)
        {
            var dict = {};
            
            //Fix certain languages' codes
            dict["ch"] = "zh"; //Chinese
            dict["ƒçe"] = "cs"; //Chinese
            dict["po"] = "pl"; //Polish
            
            code = lang.toLocaleLowerCase().substring(0,2);
            
            for(key in dict)
            {
                if(dict.hasOwnProperty(key))
                {
                    if(key === code) code = dict[key];
                }
            }
            
            return code;
        }
        
        function displayLanguage()
        {
            var message = i18n.t('messages.success', {language: language}) + ' [' + code + '].';

            alert(message);
        }
        
        /**
         * i18next -- http://i18next.com/
         */
        i18n.init
        ({
            lng: code,
            ns: 'general',
            useCookie: false,
            resGetPath: 'locales/__ns__.__lng__.json'
        }, function()
        {
            $('body').i18n();
        });
        
        getLanguage();
    </script>
  </head>
  <body>
    <button onclick="displayLanguage()" data-i18n="buttons.language">buttons.language</button>
  </body>
</html>